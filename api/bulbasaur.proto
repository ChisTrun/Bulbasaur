syntax = "proto3";

package go_pattern;

option go_package = "go_pattern/api;go_pattern";


service Bulbasaur {
    rpc SignUp (SignUpRequest) returns (SignUpResponse);
    rpc SignIn (SignInRequest) returns (SignInResponse);
    rpc RefeshToken (RefeshTokenRequest) returns (RefeshTokenResponse);
}

message TokenInfo {
    int64 user_id = 1;
    string refesh_token = 2;
    string access_token = 3;
}
  
  
message SignUpRequest {
    oneof credential {
        Local local = 1;
        Google goole = 2;
    }
    optional string device_id = 3;
    optional string device_name = 4;

    message Local {
        string username = 1;
        string password = 2;
        string confirm_password = 3;
    }

    message Google {
        // https://developers.google.com/identity/gsi/web/reference/js-reference#credential
        string credential = 1;
    }
}

message SignUpResponse {
    TokenInfo token_info = 1;
}

message SignInRequest {
    oneof credential {
        // option (validate.required) = true;
        Local local = 1;
        Google goole = 2;
    }
    optional string device_id = 3;
    optional string device_name = 4;

    message Local {
        string username = 1;
        string password = 2;
    }

    message Google {
        // https://developers.google.com/identity/gsi/web/reference/js-reference#credential
        string credential = 1;
    }
    
}

message SignInResponse {
    TokenInfo token_info = 1;
}

message RefeshTokenRequest {
    TokenInfo token_info = 1;
}

message RefeshTokenResponse {
    TokenInfo token_info = 1;
}